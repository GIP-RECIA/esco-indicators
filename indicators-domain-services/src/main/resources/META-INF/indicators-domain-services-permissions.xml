<?xml version="1.0" encoding="UTF-8" ?>

<beans 
    xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd">
    
    <!-- Bean for the permissions on establishments -->
    <bean   id="establishmentPermissionService"
            class="org.esco.indicators.services.permission.EstablishmentPermissionServiceImpl">
        <property name="establishmentViewPermissions">
            <list>
                <ref bean="localCfaEstablishmentViewPermission"/>
                <ref bean="localEscoEstablishmentViewPermission"/>
                <ref bean="localAgriEstablishmentViewPermission"/>
                <ref bean="localClg37EstablishmentViewPermission"/>
                
                <ref bean="centralCfaEstablishmentViewPermission"/>
                <ref bean="centralEscoEstablishmentViewPermission"/>
                <ref bean="centralAgriEstablishmentViewPermission"/>
                <ref bean="centralClg37EstablishmentViewPermission"/>
            </list>
        </property>
    </bean>  
    
    <!--
        ############################################################
        Local permissions
        ####################################################### 
    -->
    <bean   id="localCfaEstablishmentViewPermission"
            class="org.esco.indicators.domain.beans.permission.EstablishmentViewPermission">
            <property name="patternToMatch" value="cfa:Applications:Indicateurs:[\p{L} [0-9]]+_([0-9]+[A-Z])"/>
            <property name="patternFilter" ref="localCfaPatternFilter"/>
    </bean>
    <bean   id="localCfaPatternFilter"
            class="org.esco.indicators.domain.beans.permission.GenericFilter">
        <property name="propertiesNamesAndValues">
                <map>
                    <entry key="uai">
                        <set>
                            <value>%1%</value>
                        </set>
                    </entry>
                    <entry key="profiles">
                        <set>
                            <value>TEACHERS</value>
                            <value>APPRENTICES</value>
                            <value>STAFF</value>
                            <value>RELATIVES</value>
                            <value>TEACHERS</value>
                            <value>STAFF_COLLECTIVITY</value>
                            <value>MASTER_CRAFTSMEN</value>
                            <value>EMPLOYERS</value>
                        </set>
                    </entry>
                </map>
        </property>
    </bean>
    
    <bean   id="localEscoEstablishmentViewPermission"
            class="org.esco.indicators.domain.beans.permission.EstablishmentViewPermission">
            <property name="patternToMatch" value="esco:Applications:Indicateurs:[\p{L} [0-9]]+_([0-9]+[A-Z])"/>
            <property name="patternFilter" ref="localEscoPatternFilter"/>
    </bean>
    <bean   id="localEscoPatternFilter"
            class="org.esco.indicators.domain.beans.permission.GenericFilter">
        <property name="propertiesNamesAndValues">
                <map>
                    <entry key="uai">
                        <set>
                            <value>%1%</value>
                        </set>
                    </entry>
                    <entry key="profiles">
                        <set>
                            <value>TEACHERS</value>
                            <value>STUDENTS</value>
                            <value>STAFF</value>
                            <value>RELATIVES</value>
                            <value>TEACHERS</value>
                            <value>STAFF_COLLECTIVITY</value>
                        </set>
                    </entry>
                </map>
        </property>
    </bean>
    
    <bean   id="localAgriEstablishmentViewPermission"
            class="org.esco.indicators.domain.beans.permission.EstablishmentViewPermission">
            <property name="patternToMatch" value="agri:Applications:Indicateurs:[\p{L} [0-9]]+_([0-9]+[A-Z])"/>
            <property name="patternFilter" ref="localAgriPatternFilter"/>
    </bean>
    <bean   id="localAgriPatternFilter"
            class="org.esco.indicators.domain.beans.permission.GenericFilter">
        <property name="propertiesNamesAndValues">
                <map>
                    <entry key="uai">
                        <set>
                            <value>%1%</value>
                        </set>
                    </entry>
                    <entry key="profiles">
                        <set>
                            <value>TEACHERS</value>
                            <value>STUDENTS</value>
                            <value>STAFF</value>
                            <value>RELATIVES</value>
                            <value>TEACHERS</value>
                            <value>STAFF_COLLECTIVITY</value>
                        </set>
                    </entry>
                </map>
        </property>
    </bean>
    
    <bean   id="localClg37EstablishmentViewPermission"
            class="org.esco.indicators.domain.beans.permission.EstablishmentViewPermission">
            <property name="patternToMatch" value="clg37:Applications:Indicateurs:[\p{L} [0-9]]+_([0-9]+[A-Z])"/>
            <property name="patternFilter" ref="localClg37PatternFilter"/>
    </bean>
    <bean   id="localClg37PatternFilter"
            class="org.esco.indicators.domain.beans.permission.GenericFilter">
        <property name="propertiesNamesAndValues">
                <map>
                    <entry key="uai">
                        <set>
                            <value>%1%</value>
                        </set>
                    </entry>
                    <entry key="profiles">
	                    <set>
	                        <value>TEACHERS</value>
	                        <value>STUDENTS</value>
	                        <value>STAFF</value>
	                        <value>RELATIVES</value>
	                        <value>TEACHERS</value>
	                        <value>STAFF_COLLECTIVITY</value>
	                    </set>
	                </entry>
                </map>
        </property>
    </bean>
    
    
    
    <!--
        ############################################################
        Central permissions
        ####################################################### 
    -->
    <bean   id="centralCfaEstablishmentViewPermission"
            class="org.esco.indicators.domain.beans.permission.EstablishmentViewPermission">
        <property name="patternToMatch" value="cfa:admin:Indicateurs:central"/>
        <property name="patternFilter" ref="centralCfaPatternFilter"/>
    </bean>
    <bean   id="centralCfaPatternFilter"
            class="org.esco.indicators.domain.beans.permission.GenericFilter">
        <property name="propertiesNamesAndValues">
            <map>
                <entry key="type">
                    <set>
                        <value>CFA</value>
                    </set>
                </entry>
                <entry key="profiles">
                    <set>
                        <value>TEACHERS</value>
                        <value>APPRENTICES</value>
                        <value>STAFF</value>
                        <value>RELATIVES</value>
                        <value>TEACHERS</value>
                        <value>STAFF_COLLECTIVITY</value>
                        <value>MASTER_CRAFTSMEN</value>
                        <value>EMPLOYERS</value>
                    </set>
                </entry>
            </map>
        </property>
    </bean>
    
        
    <bean   id="centralEscoEstablishmentViewPermission"
            class="org.esco.indicators.domain.beans.permission.EstablishmentViewPermission">
        <property name="patternToMatch" value="esco:admin:Indicateurs:central"/>
        <property name="patternFilter" ref="centralEscoPatternFilter"/>
    </bean>
    <bean   id="centralEscoPatternFilter"
            class="org.esco.indicators.domain.beans.permission.GenericFilter">
        <property name="propertiesNamesAndValues">
            <map>
                <entry key="type">
                    <set>
                        <value>LEN</value>
                        <value>EREA</value>
                        <value>LEGT</value>
                        <value>LG</value>
                        <value>LP</value>
                        <value>LPO</value>
                    </set>
                </entry>
                <entry key="profiles">
                    <set>
                        <value>TEACHERS</value>
                        <value>STUDENTS</value>
                        <value>STAFF</value>
                        <value>RELATIVES</value>
                        <value>TEACHERS</value>
                        <value>STAFF_COLLECTIVITY</value>
                    </set>
                </entry>
            </map>
        </property>
    </bean>
    
    <bean   id="centralAgriEstablishmentViewPermission"
            class="org.esco.indicators.domain.beans.permission.EstablishmentViewPermission">
        <property name="patternToMatch" value="agri:admin:Indicateurs:central"/>
        <property name="patternFilter" ref="centralAgriPatternFilter"/>
    </bean>
    <bean   id="centralAgriPatternFilter"
            class="org.esco.indicators.domain.beans.permission.GenericFilter">
        <property name="propertiesNamesAndValues">
            <map>
                <entry key="type">
                    <set>
                        <value>LA</value>
                        <value>LEGTA</value>
                        <value>LPA</value>
                    </set>
                </entry>
                <entry key="profiles">
                    <set>
                        <value>TEACHERS</value>
                        <value>STUDENTS</value>
                        <value>STAFF</value>
                        <value>RELATIVES</value>
                        <value>TEACHERS</value>
                        <value>STAFF_COLLECTIVITY</value>
                    </set>
                </entry>
            </map>
        </property>
    </bean>
    
    <bean   id="centralClg37EstablishmentViewPermission"
            class="org.esco.indicators.domain.beans.permission.EstablishmentViewPermission">
        <property name="patternToMatch" value="clg37:admin:Indicateurs:central"/>
        <property name="patternFilter" ref="centralClg37PatternFilter"/>
    </bean>
    <bean   id="centralClg37PatternFilter"
            class="org.esco.indicators.domain.beans.permission.GenericFilter">
        <property name="propertiesNamesAndValues">
            <map>
                <entry key="type">
                    <set>
                        <value>COLLEGE</value>
                    </set>
                </entry>
                <entry key="profiles">
                    <set>
                        <value>TEACHERS</value>
                        <value>STUDENTS</value>
                        <value>STAFF</value>
                        <value>RELATIVES</value>
                        <value>TEACHERS</value>
                        <value>STAFF_COLLECTIVITY</value>
                    </set>
                </entry>
            </map>
        </property>
    </bean>
    
    
</beans>